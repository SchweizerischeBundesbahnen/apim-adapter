package ch.sbb.integration.api.threescale.service.cache;

import ch.sbb.integration.api.threescale.model.OAuthToken;
import org.junit.Test;

import static org.junit.Assert.*;

/**
 * Created by u217269 on 28.02.2018.
 */
public class TokenToParsedTokenCacheTest {

    protected final String validToken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJYNG05MllGS0F3cXI2dnhVMmV3RUM3aFlGLVlFSHRON3BpSmFlVVdHcEkwIn0.eyJqdGkiOiI2NGIyOTMxYS00OTNmLTRmYjYtYjUwNS1lMTUxYzZjNGQxMmMiLCJleHAiOjE1MTkzNjc1NDksIm5iZiI6MCwiaWF0IjoxNTE5MzY1NzQ5LCJpc3MiOiJodHRwczovL3Nzby5zYmIuY2gvYXV0aC9yZWFsbXMvU0JCX1B1YmxpYyIsImF1ZCI6IjA4NGU4YzMwIiwic3ViIjoiZjc1NGQ5OTAtM2ZlMS00MTEyLTk1ZmItMWNhMjYyODU3ZTI1IiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiMDg0ZThjMzAiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiIxOWMyZmNlYi0xNzBhLTQyZjUtYjUyNi02NDg5YmNhNzUxZDIiLCJhY3IiOiIxIiwiY2xpZW50X3Nlc3Npb24iOiJhYTJjYmQzZS1mMTVjLTQ3MzUtOTE4YS0wY2ZhMWIxN2Q1OTUiLCJhbGxvd2VkLW9yaWdpbnMiOltdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhcGltLWIycC1pbnQiOnsicm9sZXMiOlsiY29uc3VtZXIxIl19LCJzZXJ2aWNlLXNraWRhci1kZXYiOnsicm9sZXMiOlsidXNlciJdfSwiYXBpbS1ib29raW5nLWludCI6eyJyb2xlcyI6WyJ1c2VyIl19LCJhcGltLW5vdmFncC10ZXN0LWRlbHRhLWludCI6eyJyb2xlcyI6WyJub3ZhR1AiXX0sImFwaW0tZmJpLXRlc3QtaW50Ijp7InJvbGVzIjpbInVzZXIiXX0sImFwaW0tZnNwZy1pbnQiOnsicm9sZXMiOlsidXNlciJdfSwiYXBpbS1mYmktaW50Ijp7InJvbGVzIjpbInVzZXIiXX0sImFwaW0tbWl0YXJiZWl0ZXJkYXRlbi1pbnQiOnsicm9sZXMiOlsidXNlciJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsInZpZXctcHJvZmlsZSJdfSwiYXBpbS1mc3BnLXRlc3QtaW50Ijp7InJvbGVzIjpbInVzZXIiXX19LCJjbGllbnRJZCI6IjA4NGU4YzMwIiwiY2xpZW50SG9zdCI6IjEwLjEuOC4xIiwibmFtZSI6IiIsInByZWZlcnJlZF91c2VybmFtZSI6InNlcnZpY2UtYWNjb3VudC0wODRlOGMzMCIsImNsaWVudEFkZHJlc3MiOiIxMC4xLjguMSIsImVtYWlsIjoic2VydmljZS1hY2NvdW50LTA4NGU4YzMwQHBsYWNlaG9sZGVyLm9yZyJ9.KNELv-2iNt12yNGc1-GNdns_Td_Fz8DZfbVUgk77wQG7a9HmM8rZLZMfB7DwvpNlCHCkElCtSTgPMhkZbhpmsX_pG4FlIlExGfeiiznH1KL0jixBfSxNrlzOXar_xS57Sk2fJR16-WhmKZglcY_H67UbOMkvcgjWn8NEDNKAUttgKijAlpb1s6WMmnczC7sG7zA0WjRCVltOE1lldC1m76b59WSvn0hlYOlrrgm5RGk_vZOcjEGWtXjJdDMDSkzVlTgCmATZnRvgizWOQh5rXMlQlGMIqgFQ3bP_gmta8DTFE-IUaljQ9lzIDXRpjwf75K7pxdmWM9udKkZTT1x0Gg";
    protected final String clientId = "084e8c30";

    @Test
    public void testTokenParsing() {
        OAuthToken oAuthToken = TokenToParsedTokenCache.extractClientId(validToken);

        assertNotNull("Result from TokenToParsedTokenCache.extractClientId(...) should never be null.", oAuthToken);
        assertEquals("ClientId does not match.", clientId, oAuthToken.getClientId());
        assertFalse("Token is expected to be invalid.", oAuthToken.isValid());
        assertTrue("Token is expected to be expired.", oAuthToken.isExpired());
        assertEquals("Token type should be BEARER.", "Bearer", oAuthToken.getType());
    }

}